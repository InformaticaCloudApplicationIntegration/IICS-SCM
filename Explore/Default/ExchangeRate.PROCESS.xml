<aetgt:getResponse xmlns:aetgt="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd"
                   xmlns:types1="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd">
   <types1:Item>
      <types1:EntryId>4ARW8UBM7zsZvEI-gt-3932520-2019-01-18T11:41:16.902Z::pd.xml</types1:EntryId>
      <types1:Name>ExchangeRate</types1:Name>
      <types1:ParentFlowIds>2w4ARW8UBM7zsZv-gt-2192681-2019-01-18T11:50:13.856Z::pd.xml,HUyaaaaa-gt-4123411-2019-01-21T12:22:12.536Z::pd.xml</types1:ParentFlowIds>
      <types1:MimeType>application/xml+process</types1:MimeType>
      <types1:Description/>
      <types1:AppliesTo/>
      <types1:Tags>.agent:INFA-SERVER,.anonymous</types1:Tags>
      <types1:VersionLabel>1.0</types1:VersionLabel>
      <types1:State>CURRENT</types1:State>
      <types1:ProcessGroup/>
      <types1:CreatedBy>ganesh@na1.dm-us.org</types1:CreatedBy>
      <types1:CreationDate>2019-01-18T11:41:17Z</types1:CreationDate>
      <types1:ModifiedBy/>
      <types1:PublicationStatus>unpublished</types1:PublicationStatus>
      <types1:AutosaveExists>false</types1:AutosaveExists>
      <types1:Entry>
         <process xmlns="http://schemas.active-endpoints.com/appmodules/screenflow/2010/10/avosScreenflow.xsd"
                  xmlns:list="urn:activevos:spi:list:functions"
                  displayName="ExchangeRate"
                  name="ExchangeRate">
            <appliesTo/>
            <description/>
            <tags>.agent:INFA-SERVER,.anonymous</tags>
            <generator>Informatica Process Designer 10</generator>
            <input>
               <parameter description=""
                          name="ExchangeRequest"
                          required="true"
                          type="reference">
                  <options>
                     <option name="referenceTo">$po:ConversionRequestPO</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">elZu2PrNWsCb81uOnND1YF</option>
                  </options>
               </parameter>
            </input>
            <output>
               <field description="" name="ExchangeResponse" type="reference">
                  <options>
                     <option name="referenceTo">$po:ConversionResponsePO</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">9mTgJ7fun4Jlal0MVZGmK5</option>
                  </options>
               </field>
            </output>
            <tempFields>
               <field description="" name="ListofCurrencyExchangeRates" type="objectlist">
                  <options>
                     <option name="referenceTo">OracleConnection:CURRENCY_EXCHANGE_SVC</option>
                     <option hide="true" name="multiSelect">true</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">45AsI2OEgIHgVZdN7oZTGf</option>
                  </options>
               </field>
               <field description="" name="SQLCondition" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
            </tempFields>
            <notes/>
            <deployment suspendOnFault="false" tracingLevel="none">
               <targetLocation>INFA-SERVER</targetLocation>
               <rest>
                  <allowAnonymousAccess/>
                  <wholePayload inputWholePayload="true" outputWholePayload="true"/>
               </rest>
            </deployment>
            <flow id="a">
               <start id="b">
                  <link id="jr2f5r1w" targetId="jr2f5r1v"/>
               </start>
               <assignment id="jr2f5r1v">
                  <title>Set Sql Condition</title>
                  <operation source="formula" to="temp.SQLCondition">
                     <expression language="XQuery">(: tokenize function splits a string based on the separator provided.  In this case our separator is comma :)  

(: GBP, EUR , AUD is the input string :)       

let $rates_modified:=for $value in tokenize($input.ExchangeRequest[1]/Conversion[1]/Rate,',') 
return concat("'",$value,"'") 
return concat('(',string-join($rates_modified,','),')')  

(: The above expression constructs the SQL IN condition. The result of the above expression is ('AUD','GBP','EUR'):)</expression>
                  </operation>
                  <link id="jr2f5r23" targetId="jr2f5r22"/>
               </assignment>
               <assignment id="jr2f5r22">
                  <title>Set Sql Condition_query</title>
                  <operation source="list" to="temp.ListofCurrencyExchangeRates">
                     <query from="OracleConnection:CURRENCY_EXCHANGE_SVC">
                        <where>TO_CUR IN {$temp.SQLCondition}</where>
                     </query>
                  </operation>
                  <link id="jr2f5r2b" targetId="jr2f5r2a"/>
               </assignment>
               <assignment id="jr2f5r2a">
                  <title>Assignment to ExchangeResponse</title>
                  <operation source="formula" to="output.ExchangeResponse">
                     <expression language="XQuery">&lt;ConversionResponsePO&gt;
{
$input.ExchangeRequest[1]/BaseRate,
for $record in $temp.ListofCurrencyExchangeRates
let $value:=($input.ExchangeRequest[1]/BaseRate[1]/Value*$record/RATE_MULT) div $record/RATE_DIV
return         
&lt;Conversion&gt; 			
&lt;Value&gt;{round-half-to-even($value,2)}&lt;/Value&gt; 			
&lt;Rate&gt;{$record/TO_CUR/text()}&lt;/Rate&gt;
&lt;RateType&gt;{$record/RT_TYPE/text()}&lt;/RateType&gt; 	   
&lt;/Conversion&gt;   
}
&lt;/ConversionResponsePO&gt;</expression>
                  </operation>
                  <link id="jr2f5r2c" targetId="c"/>
               </assignment>
               <end id="c"/>
            </flow>
         </process>
      </types1:Entry>
      <types1:GUID>8AHjUFMo7OhdcULS5DNSu1</types1:GUID>
      <types1:DisplayName>ExchangeRate</types1:DisplayName>
   </types1:Item>
   <types1:CurrentServerDateTime>2019-05-13T04:33:12.742Z</types1:CurrentServerDateTime>
</aetgt:getResponse>
